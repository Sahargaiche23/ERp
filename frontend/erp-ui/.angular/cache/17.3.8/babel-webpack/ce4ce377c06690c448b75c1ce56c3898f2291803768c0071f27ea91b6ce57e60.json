{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../../services/claim.service\";\nimport * as i3 from \"../../services/auth.service\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nfunction ClaimDetailComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.…µ…µelementStart(0, \"div\", 4);\n    i0.…µ…µtext(1, \"Chargement...\");\n    i0.…µ…µelementEnd();\n  }\n}\nfunction ClaimDetailComponent_div_2_div_22_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.…µ…µgetCurrentView();\n    i0.…µ…µelementStart(0, \"div\", 29)(1, \"button\", 30);\n    i0.…µ…µlistener(\"click\", function ClaimDetailComponent_div_2_div_22_Template_button_click_1_listener() {\n      i0.…µ…µrestoreView(_r3);\n      const ctx_r1 = i0.…µ…µnextContext(2);\n      return i0.…µ…µresetView(ctx_r1.acceptClaim());\n    });\n    i0.…µ…µtext(2, \" \\u2705 Accepter \");\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(3, \"button\", 31);\n    i0.…µ…µlistener(\"click\", function ClaimDetailComponent_div_2_div_22_Template_button_click_3_listener() {\n      i0.…µ…µrestoreView(_r3);\n      const ctx_r1 = i0.…µ…µnextContext(2);\n      return i0.…µ…µresetView(ctx_r1.rejectClaim());\n    });\n    i0.…µ…µtext(4, \" \\u274C Refuser \");\n    i0.…µ…µelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.…µ…µnextContext(2);\n    i0.…µ…µadvance();\n    i0.…µ…µproperty(\"disabled\", ctx_r1.updatingStatus);\n    i0.…µ…µadvance(2);\n    i0.…µ…µproperty(\"disabled\", ctx_r1.updatingStatus);\n  }\n}\nfunction ClaimDetailComponent_div_2_div_52_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.…µ…µelementStart(0, \"div\", 15)(1, \"h3\");\n    i0.…µ…µtext(2, \"\\uD83D\\uDC68\\u200D\\uD83D\\uDCBC Agent Assign\\u00E9\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(3, \"p\");\n    i0.…µ…µtext(4);\n    i0.…µ…µelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.…µ…µnextContext(2);\n    i0.…µ…µadvance(4);\n    i0.…µ…µtextInterpolate(ctx_r1.claim.assignedTo);\n  }\n}\nfunction ClaimDetailComponent_div_2_div_53_p_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.…µ…µelementStart(0, \"p\", 34);\n    i0.…µ…µtext(1);\n    i0.…µ…µpipe(2, \"date\");\n    i0.…µ…µelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.…µ…µnextContext(3);\n    i0.…µ…µadvance();\n    i0.…µ…µtextInterpolate1(\" R\\u00E9solue le \", i0.…µ…µpipeBind2(2, 1, ctx_r1.claim.resolvedAt, \"dd/MM/yyyy \\u00E0 HH:mm\"), \" \");\n  }\n}\nfunction ClaimDetailComponent_div_2_div_53_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.…µ…µelementStart(0, \"div\", 15)(1, \"h3\");\n    i0.…µ…µtext(2, \"\\u2705 R\\u00E9solution\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(3, \"p\", 32);\n    i0.…µ…µtext(4);\n    i0.…µ…µelementEnd();\n    i0.…µ…µtemplate(5, ClaimDetailComponent_div_2_div_53_p_5_Template, 3, 4, \"p\", 33);\n    i0.…µ…µelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.…µ…µnextContext(2);\n    i0.…µ…µadvance(4);\n    i0.…µ…µtextInterpolate(ctx_r1.claim.resolution);\n    i0.…µ…µadvance();\n    i0.…µ…µproperty(\"ngIf\", ctx_r1.claim.resolvedAt);\n  }\n}\nfunction ClaimDetailComponent_div_2_div_54_button_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.…µ…µgetCurrentView();\n    i0.…µ…µelementStart(0, \"button\", 38);\n    i0.…µ…µlistener(\"click\", function ClaimDetailComponent_div_2_div_54_button_4_Template_button_click_0_listener() {\n      const status_r5 = i0.…µ…µrestoreView(_r4).$implicit;\n      const ctx_r1 = i0.…µ…µnextContext(3);\n      return i0.…µ…µresetView(ctx_r1.changeStatus(status_r5.value));\n    });\n    i0.…µ…µtext(1);\n    i0.…µ…µelementEnd();\n  }\n  if (rf & 2) {\n    const status_r5 = ctx.$implicit;\n    const ctx_r1 = i0.…µ…µnextContext(3);\n    i0.…µ…µstyleProp(\"border-color\", status_r5.color);\n    i0.…µ…µclassProp(\"active\", ctx_r1.claim.status === status_r5.value);\n    i0.…µ…µproperty(\"disabled\", ctx_r1.updatingStatus || ctx_r1.claim.status === status_r5.value);\n    i0.…µ…µadvance();\n    i0.…µ…µtextInterpolate1(\" \", status_r5.label, \" \");\n  }\n}\nfunction ClaimDetailComponent_div_2_div_54_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.…µ…µelementStart(0, \"div\", 35)(1, \"h3\");\n    i0.…µ…µtext(2, \"\\uD83D\\uDD04 Changer le Statut\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(3, \"div\", 36);\n    i0.…µ…µtemplate(4, ClaimDetailComponent_div_2_div_54_button_4_Template, 2, 6, \"button\", 37);\n    i0.…µ…µelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.…µ…µnextContext(2);\n    i0.…µ…µadvance(4);\n    i0.…µ…µproperty(\"ngForOf\", ctx_r1.statusOptions);\n  }\n}\nfunction ClaimDetailComponent_div_2_div_59_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.…µ…µelementStart(0, \"div\", 39)(1, \"div\", 40)(2, \"span\", 41);\n    i0.…µ…µtext(3);\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(4, \"span\", 42);\n    i0.…µ…µtext(5);\n    i0.…µ…µpipe(6, \"date\");\n    i0.…µ…µelementEnd()();\n    i0.…µ…µelementStart(7, \"p\", 43);\n    i0.…µ…µtext(8);\n    i0.…µ…µelementEnd()();\n  }\n  if (rf & 2) {\n    const comment_r6 = ctx.$implicit;\n    i0.…µ…µadvance(3);\n    i0.…µ…µtextInterpolate(comment_r6.author);\n    i0.…µ…µadvance(2);\n    i0.…µ…µtextInterpolate(i0.…µ…µpipeBind2(6, 3, comment_r6.createdAt, \"dd/MM/yyyy HH:mm\"));\n    i0.…µ…µadvance(3);\n    i0.…µ…µtextInterpolate(comment_r6.comment);\n  }\n}\nfunction ClaimDetailComponent_div_2_div_60_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.…µ…µelementStart(0, \"div\", 44);\n    i0.…µ…µtext(1, \" Aucun commentaire pour le moment \");\n    i0.…µ…µelementEnd();\n  }\n}\nfunction ClaimDetailComponent_div_2_div_61_span_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.…µ…µelementStart(0, \"span\");\n    i0.…µ…µtext(1, \"\\uD83D\\uDCE4 Envoyer la R\\u00E9ponse\");\n    i0.…µ…µelementEnd();\n  }\n}\nfunction ClaimDetailComponent_div_2_div_61_span_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.…µ…µelementStart(0, \"span\");\n    i0.…µ…µtext(1, \"Envoi en cours...\");\n    i0.…µ…µelementEnd();\n  }\n}\nfunction ClaimDetailComponent_div_2_div_61_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.…µ…µgetCurrentView();\n    i0.…µ…µelementStart(0, \"div\", 45)(1, \"h4\");\n    i0.…µ…µtext(2, \"\\u270D\\uFE0F Ajouter une R\\u00E9ponse\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(3, \"textarea\", 46);\n    i0.…µ…µtwoWayListener(\"ngModelChange\", function ClaimDetailComponent_div_2_div_61_Template_textarea_ngModelChange_3_listener($event) {\n      i0.…µ…µrestoreView(_r7);\n      const ctx_r1 = i0.…µ…µnextContext(2);\n      i0.…µ…µtwoWayBindingSet(ctx_r1.newComment, $event) || (ctx_r1.newComment = $event);\n      return i0.…µ…µresetView($event);\n    });\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(4, \"button\", 47);\n    i0.…µ…µlistener(\"click\", function ClaimDetailComponent_div_2_div_61_Template_button_click_4_listener() {\n      i0.…µ…µrestoreView(_r7);\n      const ctx_r1 = i0.…µ…µnextContext(2);\n      return i0.…µ…µresetView(ctx_r1.addComment());\n    });\n    i0.…µ…µtemplate(5, ClaimDetailComponent_div_2_div_61_span_5_Template, 2, 0, \"span\", 2)(6, ClaimDetailComponent_div_2_div_61_span_6_Template, 2, 0, \"span\", 2);\n    i0.…µ…µelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.…µ…µnextContext(2);\n    i0.…µ…µadvance(3);\n    i0.…µ…µtwoWayProperty(\"ngModel\", ctx_r1.newComment);\n    i0.…µ…µadvance();\n    i0.…µ…µproperty(\"disabled\", !ctx_r1.newComment.trim() || ctx_r1.addingComment);\n    i0.…µ…µadvance();\n    i0.…µ…µproperty(\"ngIf\", !ctx_r1.addingComment);\n    i0.…µ…µadvance();\n    i0.…µ…µproperty(\"ngIf\", ctx_r1.addingComment);\n  }\n}\nfunction ClaimDetailComponent_div_2_div_62_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.…µ…µelementStart(0, \"div\", 48)(1, \"p\");\n    i0.…µ…µtext(2, \"\\uD83D\\uDCA1 Vous pouvez suivre l'\\u00E9volution de votre r\\u00E9clamation ici. Les agents vous r\\u00E9pondront dans cette section.\");\n    i0.…µ…µelementEnd()();\n  }\n}\nfunction ClaimDetailComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.…µ…µgetCurrentView();\n    i0.…µ…µelementStart(0, \"div\")(1, \"div\", 5)(2, \"button\", 6);\n    i0.…µ…µlistener(\"click\", function ClaimDetailComponent_div_2_Template_button_click_2_listener() {\n      i0.…µ…µrestoreView(_r1);\n      const ctx_r1 = i0.…µ…µnextContext();\n      return i0.…µ…µresetView(ctx_r1.goBack());\n    });\n    i0.…µ…µtext(3, \"\\u2190 Retour\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(4, \"div\")(5, \"h1\");\n    i0.…µ…µtext(6);\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(7, \"p\");\n    i0.…µ…µtext(8);\n    i0.…µ…µpipe(9, \"date\");\n    i0.…µ…µelementEnd()()();\n    i0.…µ…µelementStart(10, \"div\", 7)(11, \"div\", 8)(12, \"div\", 9)(13, \"h2\");\n    i0.…µ…µtext(14);\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(15, \"div\", 10)(16, \"span\", 11);\n    i0.…µ…µtext(17);\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(18, \"span\", 12);\n    i0.…µ…µtext(19);\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(20, \"span\", 13);\n    i0.…µ…µtext(21);\n    i0.…µ…µelementEnd()()();\n    i0.…µ…µtemplate(22, ClaimDetailComponent_div_2_div_22_Template, 5, 2, \"div\", 14);\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(23, \"div\", 15)(24, \"h3\");\n    i0.…µ…µtext(25, \"\\uD83D\\uDC64 Informations du Citoyen\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(26, \"div\", 16)(27, \"div\", 17)(28, \"span\", 18);\n    i0.…µ…µtext(29, \"Nom:\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(30, \"span\", 19);\n    i0.…µ…µtext(31);\n    i0.…µ…µelementEnd()();\n    i0.…µ…µelementStart(32, \"div\", 17)(33, \"span\", 18);\n    i0.…µ…µtext(34, \"Email:\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(35, \"span\", 19);\n    i0.…µ…µtext(36);\n    i0.…µ…µelementEnd()();\n    i0.…µ…µelementStart(37, \"div\", 17)(38, \"span\", 18);\n    i0.…µ…µtext(39, \"T\\u00E9l\\u00E9phone:\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(40, \"span\", 19);\n    i0.…µ…µtext(41);\n    i0.…µ…µelementEnd()();\n    i0.…µ…µelementStart(42, \"div\", 17)(43, \"span\", 18);\n    i0.…µ…µtext(44, \"Adresse:\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(45, \"span\", 19);\n    i0.…µ…µtext(46);\n    i0.…µ…µelementEnd()()()();\n    i0.…µ…µelementStart(47, \"div\", 15)(48, \"h3\");\n    i0.…µ…µtext(49, \"\\uD83D\\uDCC4 Description\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(50, \"p\", 20);\n    i0.…µ…µtext(51);\n    i0.…µ…µelementEnd()();\n    i0.…µ…µtemplate(52, ClaimDetailComponent_div_2_div_52_Template, 5, 1, \"div\", 21)(53, ClaimDetailComponent_div_2_div_53_Template, 6, 2, \"div\", 21);\n    i0.…µ…µelementEnd();\n    i0.…µ…µtemplate(54, ClaimDetailComponent_div_2_div_54_Template, 5, 1, \"div\", 22);\n    i0.…µ…µelementStart(55, \"div\", 23)(56, \"h3\");\n    i0.…µ…µtext(57, \"\\uD83D\\uDCAC Historique et Commentaires\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(58, \"div\", 24);\n    i0.…µ…µtemplate(59, ClaimDetailComponent_div_2_div_59_Template, 9, 6, \"div\", 25)(60, ClaimDetailComponent_div_2_div_60_Template, 2, 0, \"div\", 26);\n    i0.…µ…µelementEnd();\n    i0.…µ…µtemplate(61, ClaimDetailComponent_div_2_div_61_Template, 7, 4, \"div\", 27)(62, ClaimDetailComponent_div_2_div_62_Template, 3, 0, \"div\", 28);\n    i0.…µ…µelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.…µ…µnextContext();\n    i0.…µ…µadvance(6);\n    i0.…µ…µtextInterpolate1(\"R\\u00E9clamation #\", ctx_r1.claim.id, \"\");\n    i0.…µ…µadvance(2);\n    i0.…µ…µtextInterpolate1(\"Cr\\u00E9\\u00E9e le \", i0.…µ…µpipeBind2(9, 22, ctx_r1.claim.createdAt, \"dd/MM/yyyy \\u00E0 HH:mm\"), \"\");\n    i0.…µ…µadvance(6);\n    i0.…µ…µtextInterpolate(ctx_r1.claim.subject);\n    i0.…µ…µadvance(2);\n    i0.…µ…µstyleProp(\"background-color\", ctx_r1.getStatusColor(ctx_r1.claim.status));\n    i0.…µ…µadvance();\n    i0.…µ…µtextInterpolate1(\" \", ctx_r1.getStatusLabel(ctx_r1.claim.status), \" \");\n    i0.…µ…µadvance(2);\n    i0.…µ…µtextInterpolate2(\" \", ctx_r1.getPriorityIcon(ctx_r1.claim.priority), \" \", ctx_r1.claim.priority, \" \");\n    i0.…µ…µadvance(2);\n    i0.…µ…µtextInterpolate1(\" \", ctx_r1.getCategoryLabel(ctx_r1.claim.category), \" \");\n    i0.…µ…µadvance();\n    i0.…µ…µproperty(\"ngIf\", ctx_r1.canAcceptReject() && ctx_r1.claim.status === \"NEW\");\n    i0.…µ…µadvance(9);\n    i0.…µ…µtextInterpolate(ctx_r1.claim.citizenName);\n    i0.…µ…µadvance(5);\n    i0.…µ…µtextInterpolate(ctx_r1.claim.citizenEmail);\n    i0.…µ…µadvance(5);\n    i0.…µ…µtextInterpolate(ctx_r1.claim.citizenPhone);\n    i0.…µ…µadvance(5);\n    i0.…µ…µtextInterpolate(ctx_r1.claim.address);\n    i0.…µ…µadvance(5);\n    i0.…µ…µtextInterpolate(ctx_r1.claim.description);\n    i0.…µ…µadvance();\n    i0.…µ…µproperty(\"ngIf\", ctx_r1.claim.assignedTo);\n    i0.…µ…µadvance();\n    i0.…µ…µproperty(\"ngIf\", ctx_r1.claim.resolution);\n    i0.…µ…µadvance();\n    i0.…µ…µproperty(\"ngIf\", ctx_r1.canChangeStatus() && ctx_r1.claim.status !== \"CLOSED\");\n    i0.…µ…µadvance(5);\n    i0.…µ…µproperty(\"ngForOf\", ctx_r1.comments);\n    i0.…µ…µadvance();\n    i0.…µ…µproperty(\"ngIf\", ctx_r1.comments.length === 0);\n    i0.…µ…µadvance();\n    i0.…µ…µproperty(\"ngIf\", ctx_r1.canRespond());\n    i0.…µ…µadvance();\n    i0.…µ…µproperty(\"ngIf\", ctx_r1.isCitizen());\n  }\n}\nfunction ClaimDetailComponent_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.…µ…µgetCurrentView();\n    i0.…µ…µelementStart(0, \"div\", 49)(1, \"h2\");\n    i0.…µ…µtext(2, \"R\\u00E9clamation non trouv\\u00E9e\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(3, \"button\", 50);\n    i0.…µ…µlistener(\"click\", function ClaimDetailComponent_div_3_Template_button_click_3_listener() {\n      i0.…µ…µrestoreView(_r8);\n      const ctx_r1 = i0.…µ…µnextContext();\n      return i0.…µ…µresetView(ctx_r1.goBack());\n    });\n    i0.…µ…µtext(4, \"Retour \\u00E0 la liste\");\n    i0.…µ…µelementEnd()();\n  }\n}\nexport let ClaimDetailComponent = /*#__PURE__*/(() => {\n  class ClaimDetailComponent {\n    route;\n    router;\n    claimService;\n    authService;\n    claim = null;\n    comments = [];\n    currentUser = null;\n    loading = true;\n    newComment = '';\n    addingComment = false;\n    updatingStatus = false;\n    statusOptions = [{\n      value: 'NEW',\n      label: 'Nouvelle',\n      color: '#3b82f6'\n    }, {\n      value: 'IN_PROGRESS',\n      label: 'En cours',\n      color: '#f59e0b'\n    }, {\n      value: 'RESOLVED',\n      label: 'R√©solue',\n      color: '#10b981'\n    }, {\n      value: 'CLOSED',\n      label: 'Ferm√©e',\n      color: '#6b7280'\n    }, {\n      value: 'REJECTED',\n      label: 'Rejet√©e',\n      color: '#ef4444'\n    }];\n    constructor(route, router, claimService, authService) {\n      this.route = route;\n      this.router = router;\n      this.claimService = claimService;\n      this.authService = authService;\n    }\n    ngOnInit() {\n      this.currentUser = this.authService.getCurrentUser();\n      const id = this.route.snapshot.paramMap.get('id');\n      if (id) {\n        this.loadClaim(id);\n        this.loadComments(id);\n      } else {\n        this.loading = false;\n        this.router.navigate(['/dashboard/claims']);\n      }\n    }\n    loadClaim(id) {\n      this.claimService.getClaim(id).subscribe({\n        next: data => {\n          this.claim = data;\n          this.loading = false;\n        },\n        error: err => {\n          console.error('Error loading claim:', err);\n          this.loading = false;\n          // Rediriger vers la liste si r√©clamation non trouv√©e\n          setTimeout(() => {\n            this.router.navigate(['/dashboard/claims']);\n          }, 2000);\n        }\n      });\n    }\n    loadComments(id) {\n      this.claimService.getComments(id).subscribe({\n        next: data => {\n          this.comments = data;\n        },\n        error: err => {\n          console.error('Error loading comments:', err);\n        }\n      });\n    }\n    // V√©rification des r√¥les\n    isCitizen() {\n      return this.currentUser?.role?.toUpperCase() === 'CITIZEN';\n    }\n    isAgent() {\n      return this.currentUser?.role?.toUpperCase() === 'AGENT';\n    }\n    isChief() {\n      return this.currentUser?.role?.toUpperCase() === 'CHIEF';\n    }\n    isAdmin() {\n      return this.currentUser?.role?.toUpperCase() === 'ADMIN';\n    }\n    // Permissions\n    canAcceptReject() {\n      return this.isChief() || this.isAdmin();\n    }\n    canRespond() {\n      return this.isAgent() || this.isChief() || this.isAdmin();\n    }\n    canChangeStatus() {\n      return this.isAgent() || this.isChief() || this.isAdmin();\n    }\n    // Actions\n    acceptClaim() {\n      if (!this.claim || !this.canAcceptReject()) return;\n      this.updatingStatus = true;\n      this.claimService.updateClaimStatus(this.claim.id, 'IN_PROGRESS').subscribe({\n        next: () => {\n          if (this.claim) {\n            this.claim.status = 'IN_PROGRESS';\n            this.addSystemComment('R√©clamation accept√©e et prise en charge');\n          }\n          this.updatingStatus = false;\n        },\n        error: err => {\n          console.error('Error accepting claim:', err);\n          this.updatingStatus = false;\n        }\n      });\n    }\n    rejectClaim() {\n      if (!this.claim || !this.canAcceptReject()) return;\n      const reason = prompt('Raison du refus:');\n      if (!reason) return;\n      this.updatingStatus = true;\n      this.claimService.updateClaimStatus(this.claim.id, 'REJECTED', reason).subscribe({\n        next: () => {\n          if (this.claim) {\n            this.claim.status = 'REJECTED';\n            this.claim.resolution = reason;\n            this.addSystemComment(`R√©clamation rejet√©e. Raison: ${reason}`);\n          }\n          this.updatingStatus = false;\n        },\n        error: err => {\n          console.error('Error rejecting claim:', err);\n          this.updatingStatus = false;\n        }\n      });\n    }\n    changeStatus(newStatus) {\n      if (!this.claim || !this.canChangeStatus()) return;\n      this.updatingStatus = true;\n      this.claimService.updateClaimStatus(this.claim.id, newStatus).subscribe({\n        next: () => {\n          if (this.claim) {\n            this.claim.status = newStatus;\n            this.addSystemComment(`Statut chang√© √†: ${this.getStatusLabel(newStatus)}`);\n          }\n          this.updatingStatus = false;\n        },\n        error: err => {\n          console.error('Error changing status:', err);\n          this.updatingStatus = false;\n        }\n      });\n    }\n    addComment() {\n      if (!this.claim || !this.newComment.trim() || !this.canRespond()) return;\n      this.addingComment = true;\n      // Utiliser l'endpoint /respond au lieu de /comments\n      this.claimService.respondToClaim(this.claim.id, this.newComment).subscribe({\n        next: updatedClaim => {\n          // Ajouter le commentaire √† l'historique local\n          this.addSystemComment(this.newComment);\n          this.newComment = '';\n          this.addingComment = false;\n          alert('R√©ponse envoy√©e avec succ√®s!');\n        },\n        error: err => {\n          console.error('Error adding comment:', err);\n          this.addingComment = false;\n          alert('Erreur lors de l\\'envoi de la r√©ponse');\n        }\n      });\n    }\n    addSystemComment(message) {\n      const systemComment = {\n        id: Date.now(),\n        claimId: this.claim.id,\n        author: this.currentUser?.username || 'System',\n        comment: message,\n        createdAt: new Date()\n      };\n      this.comments.push(systemComment);\n    }\n    getStatusLabel(status) {\n      return this.statusOptions.find(s => s.value === status)?.label || status;\n    }\n    getStatusColor(status) {\n      return this.statusOptions.find(s => s.value === status)?.color || '#6b7280';\n    }\n    getPriorityIcon(priority) {\n      const icons = {\n        'LOW': 'üü¢',\n        'MEDIUM': 'üü°',\n        'HIGH': 'üü†',\n        'URGENT': 'üî¥'\n      };\n      return icons[priority] || '‚ö™';\n    }\n    getCategoryLabel(category) {\n      const labels = {\n        'INFRASTRUCTURE': 'üèóÔ∏è Infrastructure',\n        'SANITATION': 'üßπ Assainissement',\n        'LIGHTING': 'üí° √âclairage',\n        'SECURITY': 'üõ°Ô∏è S√©curit√©',\n        'ADMINISTRATIVE': 'üìã Administratif',\n        'OTHER': '‚ùì Autre'\n      };\n      return labels[category] || category;\n    }\n    goBack() {\n      this.router.navigate(['/dashboard/claims']);\n    }\n    static …µfac = function ClaimDetailComponent_Factory(t) {\n      return new (t || ClaimDetailComponent)(i0.…µ…µdirectiveInject(i1.ActivatedRoute), i0.…µ…µdirectiveInject(i1.Router), i0.…µ…µdirectiveInject(i2.ClaimService), i0.…µ…µdirectiveInject(i3.AuthService));\n    };\n    static …µcmp = /*@__PURE__*/i0.…µ…µdefineComponent({\n      type: ClaimDetailComponent,\n      selectors: [[\"app-claim-detail\"]],\n      decls: 4,\n      vars: 3,\n      consts: [[1, \"page-container\"], [\"class\", \"loading\", 4, \"ngIf\"], [4, \"ngIf\"], [\"class\", \"error-message\", 4, \"ngIf\"], [1, \"loading\"], [1, \"page-header\"], [1, \"btn-back\", 3, \"click\"], [1, \"claim-info-card\"], [1, \"claim-header\"], [1, \"claim-title\"], [1, \"claim-meta\"], [1, \"badge\"], [1, \"priority-badge\"], [1, \"category-badge\"], [\"class\", \"claim-actions\", 4, \"ngIf\"], [1, \"info-section\"], [1, \"info-grid\"], [1, \"info-item\"], [1, \"info-label\"], [1, \"info-value\"], [1, \"description\"], [\"class\", \"info-section\", 4, \"ngIf\"], [\"class\", \"status-change-card\", 4, \"ngIf\"], [1, \"comments-card\"], [1, \"comments-list\"], [\"class\", \"comment\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"no-comments\", 4, \"ngIf\"], [\"class\", \"add-comment\", 4, \"ngIf\"], [\"class\", \"citizen-info\", 4, \"ngIf\"], [1, \"claim-actions\"], [1, \"btn\", \"btn-success\", 3, \"click\", \"disabled\"], [1, \"btn\", \"btn-danger\", 3, \"click\", \"disabled\"], [1, \"resolution\"], [\"class\", \"resolution-date\", 4, \"ngIf\"], [1, \"resolution-date\"], [1, \"status-change-card\"], [1, \"status-buttons\"], [\"class\", \"btn-status\", 3, \"active\", \"border-color\", \"disabled\", \"click\", 4, \"ngFor\", \"ngForOf\"], [1, \"btn-status\", 3, \"click\", \"disabled\"], [1, \"comment\"], [1, \"comment-header\"], [1, \"comment-author\"], [1, \"comment-date\"], [1, \"comment-text\"], [1, \"no-comments\"], [1, \"add-comment\"], [\"placeholder\", \"\\u00C9crivez votre r\\u00E9ponse au citoyen...\", \"rows\", \"4\", 1, \"comment-input\", 3, \"ngModelChange\", \"ngModel\"], [1, \"btn\", \"btn-primary\", 3, \"click\", \"disabled\"], [1, \"citizen-info\"], [1, \"error-message\"], [1, \"btn\", \"btn-primary\", 3, \"click\"]],\n      template: function ClaimDetailComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.…µ…µelementStart(0, \"div\", 0);\n          i0.…µ…µtemplate(1, ClaimDetailComponent_div_1_Template, 2, 0, \"div\", 1)(2, ClaimDetailComponent_div_2_Template, 63, 25, \"div\", 2)(3, ClaimDetailComponent_div_3_Template, 5, 0, \"div\", 3);\n          i0.…µ…µelementEnd();\n        }\n        if (rf & 2) {\n          i0.…µ…µadvance();\n          i0.…µ…µproperty(\"ngIf\", ctx.loading);\n          i0.…µ…µadvance();\n          i0.…µ…µproperty(\"ngIf\", !ctx.loading && ctx.claim);\n          i0.…µ…µadvance();\n          i0.…µ…µproperty(\"ngIf\", !ctx.loading && !ctx.claim);\n        }\n      },\n      dependencies: [i4.NgForOf, i4.NgIf, i5.DefaultValueAccessor, i5.NgControlStatus, i5.NgModel, i4.DatePipe],\n      styles: [\".page-container[_ngcontent-%COMP%]{padding:24px;max-width:1200px;margin:0 auto}.page-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;margin-bottom:24px}.btn-back[_ngcontent-%COMP%]{padding:8px 16px;background:#f3f4f6;border:none;border-radius:8px;cursor:pointer;font-size:14px;font-weight:500;transition:background .2s}.btn-back[_ngcontent-%COMP%]:hover{background:#e5e7eb}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:28px;font-weight:600;color:#1a1a1a;margin:0}.page-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666;font-size:14px;margin:4px 0 0}.claim-info-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 2px 8px #0000001a;padding:32px;margin-bottom:24px}.claim-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:start;margin-bottom:24px;padding-bottom:24px;border-bottom:2px solid #e5e5e5}.claim-title[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;font-weight:600;color:#1a1a1a;margin:0 0 12px}.claim-meta[_ngcontent-%COMP%]{display:flex;gap:12px;flex-wrap:wrap}.badge[_ngcontent-%COMP%]{padding:6px 12px;border-radius:6px;color:#fff;font-size:13px;font-weight:500}.priority-badge[_ngcontent-%COMP%], .category-badge[_ngcontent-%COMP%]{padding:6px 12px;border-radius:6px;background:#f3f4f6;color:#374151;font-size:13px;font-weight:500}.claim-actions[_ngcontent-%COMP%]{display:flex;gap:12px}.btn[_ngcontent-%COMP%]{padding:10px 20px;border:none;border-radius:8px;font-weight:500;font-size:14px;cursor:pointer;transition:all .2s}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn-success[_ngcontent-%COMP%]{background:#10b981;color:#fff}.btn-success[_ngcontent-%COMP%]:hover:not(:disabled){background:#059669;transform:translateY(-2px);box-shadow:0 4px 12px #10b9814d}.btn-danger[_ngcontent-%COMP%]{background:#ef4444;color:#fff}.btn-danger[_ngcontent-%COMP%]:hover:not(:disabled){background:#dc2626;transform:translateY(-2px);box-shadow:0 4px 12px #ef44444d}.btn-primary[_ngcontent-%COMP%]{background:#5b7cfc;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#4c6eef;transform:translateY(-2px);box-shadow:0 4px 12px #5b7cfc4d}.info-section[_ngcontent-%COMP%]{margin-bottom:24px}.info-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#1a1a1a;margin-bottom:16px}.info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px}.info-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.info-label[_ngcontent-%COMP%]{font-size:13px;color:#666;font-weight:500}.info-value[_ngcontent-%COMP%]{font-size:15px;color:#1a1a1a;font-weight:500}.description[_ngcontent-%COMP%]{color:#374151;line-height:1.6;font-size:15px}.resolution[_ngcontent-%COMP%]{background:#d1fae5;padding:16px;border-radius:8px;border-left:4px solid #10b981;color:#065f46;line-height:1.6}.resolution-date[_ngcontent-%COMP%]{font-size:13px;color:#666;margin-top:8px}.status-change-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 2px 8px #0000001a;padding:24px;margin-bottom:24px}.status-change-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px;font-weight:600;margin-bottom:16px}.status-buttons[_ngcontent-%COMP%]{display:flex;gap:12px;flex-wrap:wrap}.btn-status[_ngcontent-%COMP%]{padding:10px 20px;background:#fff;border:2px solid #d1d5db;border-radius:8px;font-weight:500;font-size:14px;cursor:pointer;transition:all .2s}.btn-status[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 4px 12px #0000001a}.btn-status.active[_ngcontent-%COMP%]{background:#f3f4f6;border-width:3px}.btn-status[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.comments-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 2px 8px #0000001a;padding:32px}.comments-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:20px;font-weight:600;margin-bottom:24px}.comments-list[_ngcontent-%COMP%]{margin-bottom:24px;max-height:400px;overflow-y:auto}.comment[_ngcontent-%COMP%]{background:#f9fafb;padding:16px;border-radius:8px;margin-bottom:12px;border-left:4px solid #5b7cfc}.comment-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:8px}.comment-author[_ngcontent-%COMP%]{font-weight:600;color:#1a1a1a;font-size:14px}.comment-date[_ngcontent-%COMP%]{font-size:13px;color:#666}.comment-text[_ngcontent-%COMP%]{color:#374151;line-height:1.6;margin:0}.no-comments[_ngcontent-%COMP%]{text-align:center;padding:40px;color:#9ca3af;font-style:italic}.add-comment[_ngcontent-%COMP%]{border-top:2px solid #e5e5e5;padding-top:24px}.add-comment[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:16px;font-weight:600;margin-bottom:12px}.comment-input[_ngcontent-%COMP%]{width:100%;padding:12px;border:2px solid #d1d5db;border-radius:8px;font-size:14px;resize:vertical;margin-bottom:12px;font-family:inherit}.comment-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#5b7cfc;box-shadow:0 0 0 3px #5b7cfc1a}.citizen-info[_ngcontent-%COMP%]{background:#dbeafe;padding:16px;border-radius:8px;border-left:4px solid #3b82f6;color:#1e40af;margin-top:16px}.citizen-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;line-height:1.6}.loading[_ngcontent-%COMP%]{text-align:center;padding:60px;font-size:18px;color:#666}.error-message[_ngcontent-%COMP%]{text-align:center;padding:60px}.error-message[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#ef4444;margin-bottom:24px}@media (max-width: 768px){.claim-header[_ngcontent-%COMP%]{flex-direction:column;gap:16px}.claim-actions[_ngcontent-%COMP%]{width:100%}.info-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.status-buttons[_ngcontent-%COMP%]{flex-direction:column}.btn-status[_ngcontent-%COMP%]{width:100%}}\"]\n    });\n  }\n  return ClaimDetailComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}