{"ast":null,"code":"import { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nexport let NotificationService = /*#__PURE__*/(() => {\n  class NotificationService {\n    notificationsSubject = new BehaviorSubject([]);\n    notifications$ = this.notificationsSubject.asObservable();\n    constructor() {\n      // Charger les notifications du localStorage au d√©marrage\n      this.loadNotifications();\n    }\n    loadNotifications() {\n      const stored = localStorage.getItem('notifications');\n      if (stored) {\n        try {\n          const notifications = JSON.parse(stored);\n          this.notificationsSubject.next(notifications);\n        } catch (e) {\n          console.error('Error loading notifications:', e);\n        }\n      }\n    }\n    saveNotifications() {\n      localStorage.setItem('notifications', JSON.stringify(this.notificationsSubject.value));\n    }\n    getNotifications() {\n      return this.notifications$;\n    }\n    getUnreadCount() {\n      return this.notificationsSubject.value.filter(n => !n.read).length;\n    }\n    createNotification(notification) {\n      const newNotification = {\n        ...notification,\n        id: this.generateId(),\n        createdAt: new Date()\n      };\n      const current = this.notificationsSubject.value;\n      this.notificationsSubject.next([newNotification, ...current]);\n      this.saveNotifications();\n    }\n    markAsRead(id) {\n      const updated = this.notificationsSubject.value.map(n => n.id === id ? {\n        ...n,\n        read: true\n      } : n);\n      this.notificationsSubject.next(updated);\n      this.saveNotifications();\n    }\n    markAllAsRead() {\n      const updated = this.notificationsSubject.value.map(n => ({\n        ...n,\n        read: true\n      }));\n      this.notificationsSubject.next(updated);\n      this.saveNotifications();\n    }\n    deleteNotification(id) {\n      const updated = this.notificationsSubject.value.filter(n => n.id !== id);\n      this.notificationsSubject.next(updated);\n      this.saveNotifications();\n    }\n    clearAll() {\n      this.notificationsSubject.next([]);\n      localStorage.removeItem('notifications');\n    }\n    generateId() {\n      return `notif_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n    }\n    // Notifications sp√©cifiques\n    notifyClaimCreated(claimId, citizenName, subject) {\n      this.createNotification({\n        userId: 'chief',\n        // Envoyer au CHIEF\n        type: 'CLAIM_CREATED',\n        title: 'üìù Nouvelle R√©clamation',\n        message: `${citizenName} a cr√©√© une r√©clamation: \"${subject}\"`,\n        claimId,\n        read: false\n      });\n    }\n    notifyClaimAssigned(claimId, agentName, subject) {\n      this.createNotification({\n        userId: 'agent',\n        // Envoyer √† l'AGENT\n        type: 'CLAIM_ASSIGNED',\n        title: 'üìã R√©clamation Assign√©e',\n        message: `Vous avez √©t√© assign√© √†: \"${subject}\"`,\n        claimId,\n        read: false\n      });\n    }\n    notifyClaimStatusChanged(claimId, status, subject) {\n      this.createNotification({\n        userId: 'citizen',\n        // Envoyer au CITIZEN\n        type: 'CLAIM_STATUS_CHANGED',\n        title: 'üîî Statut Mis √† Jour',\n        message: `Votre r√©clamation \"${subject}\" est maintenant: ${status}`,\n        claimId,\n        read: false\n      });\n    }\n    static …µfac = function NotificationService_Factory(t) {\n      return new (t || NotificationService)();\n    };\n    static …µprov = /*@__PURE__*/i0.…µ…µdefineInjectable({\n      token: NotificationService,\n      factory: NotificationService.…µfac,\n      providedIn: 'root'\n    });\n  }\n  return NotificationService;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}